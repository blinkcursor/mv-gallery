function parseSrcset(t){function e(t){return" "===t||"	"===t||"\n"===t||"\f"===t||"\r"===t}function i(e){var i,s=e.exec(t.substring(p));return s?(i=s[0],p+=i.length,i):void 0}function s(){for(i(d),a="",r="in descriptor";;){if(c=t.charAt(p),"in descriptor"===r)if(e(c))a&&(h.push(a),a="",r="after descriptor");else{if(","===c)return p+=1,a&&h.push(a),void o();if("("===c)a+=c,r="in parens";else{if(""===c)return a&&h.push(a),void o();a+=c}}else if("in parens"===r)if(")"===c)a+=c,r="in descriptor";else{if(""===c)return h.push(a),void o();a+=c}else if("after descriptor"===r)if(e(c));else{if(""===c)return void o();r="in descriptor",p-=1}p+=1}}function o(){var e,i,s,o,a,r,c,l,d,u=!1,m={};for(o=0;o<h.length;o++)a=h[o],r=a[a.length-1],c=a.substring(0,a.length-1),l=parseInt(c,10),d=parseFloat(c),v.test(c)&&"w"===r?((e||i)&&(u=!0),0===l?u=!0:e=l):f.test(c)&&"x"===r?((e||i||s)&&(u=!0),0>d?u=!0:i=d):v.test(c)&&"h"===r?((s||i)&&(u=!0),0===l?u=!0:s=l):u=!0;u?window&&window.console&&console.log&&console.log("Invalid srcset descriptor found in '"+t+"' at '"+a+"'."):(m.url=n,e&&(m.w=e),i&&(m.d=i),s&&(m.h=s),w.push(m))}for(var n,h,a,r,c,l=t.length,d=/^[ \t\n\r\u000c]+/,u=/^[, \t\n\r\u000c]+/,m=/^[^ \t\n\r\u000c]+/,g=/[,]+$/,v=/^\d+$/,f=/^-?(?:[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/,p=0,w=[];;){if(i(u),p>=l)return w;n=i(m),h=[],","===n.slice(-1)?(n=n.replace(g,""),o()):s()}}!function(){this.touchy={init:function(){this.bindEvents()},bindEvents:function(){this.thisTouchStart=this.touchStart.bind(this),window.addEventListener("touchstart",this.thisTouchStart,!1)},touchStart:function(t){this.oTouch={},1===t.touches.length&&(this.oTouch.startTime=Date.now(),this.oTouch.startX=t.touches[0].clientX,this.oTouch.startY=t.touches[0].clientY,this.oTouch.target=t.touches[0].target)},touchMove:function(t){},touchEnd:function(t){if(this.oTouch.startTime){touchy.oTouch.duration=Date.now()-touchy.oTouch.startTime,touchy.oTouch.endX=t.changedTouches[0].clientX,touchy.oTouch.endY=t.changedTouches[0].clientY;var e=touchy.oTouch.endX-touchy.oTouch.startX,i=Math.abs(e/document.documentElement.clientWidth),s=touchy.oTouch.endY-touchy.oTouch.startY,o=Math.abs(s/document.documentElement.clientHeight);return Math.max(i,o)>.1?i>o?touchy.oTouch.gesture=e>0?"swiperight":"swipeleft":touchy.oTouch.gesture=s>0?"swipedown":"swipeup":touchy.oTouch.gesture="tap",touchy.oTouch}},quietTouchy:function(){window.removeEventListener("touchstart",this.thisTouchStart,!1)}}}(),function(){function t(t,e){t.parentNode.insertBefore(e,t.nextSibling)}this.mvGallery={init:function(t){this.cacheDOM(t),this.gallery&&this.gallery.addEventListener("click",this.launchModal.bind(this),!1)},cacheDOM:function(t){this.gallery=document.querySelector(t)},launchModal:function(e){e.preventDefault(),this.modal=document.createElement("div"),this.modal.classList.add("mvgallery__modal"),this.arrowLeft=document.createElement("div"),this.arrowLeft.classList.add("mvgallery__left"),this.arrowRight=document.createElement("div"),this.arrowRight.classList.add("mvgallery__right"),this.close=document.createElement("div"),this.close.classList.add("mvgallery__close"),this.modal.appendChild(this.arrowLeft),this.modal.appendChild(this.arrowRight),this.modal.appendChild(this.close),t(this.gallery,this.modal),this.images=Array.prototype.slice.call(this.gallery.querySelectorAll("img")),this.currentImage=e.target;var i=this.cloneImage(this.currentImage);this.modal.appendChild(i),this.bindModalEvents()},cloneImage:function(t){var e=t.cloneNode(!0),i=this.modal.clientWidth,s=this.modal.clientHeight,o=i/s,n=t.naturalWidth||e.width,h=t.naturalHeight||e.height,a=n/h,r=o>a?Math.round(i*a/o)+"px":"100vw";if(e.sizes)e.sizes=r;else{for(var c=document.createElement("img"),l=parseSrcset(e.srcset),d="100vw"===r?i:parseInt(r,10),u=0;l[u].w<d;)u++;c.src=l[u].url,e=c}return e},bindModalEvents:function(){touchy.init(),this.thisHandleModalEvents=this.handleModalEvents.bind(this),window.addEventListener("keyup",this.thisHandleModalEvents,!1),this.modal.addEventListener("click",this.thisHandleModalEvents,!1),window.addEventListener("touchend",this.thisHandleModalEvents,!1)},handleModalEvents:function(t){if("keyup"===t.type){var e=t.keyCode||t.which;switch(e){case 27:this.killModal();break;case 37:this.updateModal(-1);break;case 39:this.updateModal(1)}}if("click"===t.type&&(t.target!==this.modal&&t.target!==this.close||this.killModal(),t.target===this.arrowLeft?this.updateModal(-1):t.target===this.arrowRight&&this.updateModal(1)),"touchend"===t.type){var i=touchy.touchEnd(t);switch(i.gesture){case"swipeleft":this.updateModal(-1);break;case"swiperight":this.updateModal(1)}}},updateModal:function(t){var e=this.images.indexOf(this.currentImage),i=e+t;i=i===this.images.length?0:i,i=0>i?this.images.length-1:i;var s=this.images[i];this.modal.removeChild(this.modal.querySelector("img")),this.currentImage=s;var o=this.cloneImage(this.currentImage);this.modal.insertBefore(o,this.modal.firstChild)},killModal:function(){this.modal.removeEventListener("click",this.thisHandleModalEvents,!1),window.removeEventListener("keyup",this.thisHandleModalEvents,!1),window.removeEventListener("touchend",this.thisHandleModalEvents,!1),this.modal.parentNode.removeChild(this.modal),touchy.quietTouchy()}}}();